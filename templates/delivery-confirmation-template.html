<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
  ★ 중요 ★ 환경별 이미지 경로 설정

  1. 로고 이미지 경로:
     - 개발 환경 (Windows): D:/dev/ptlpsmback/logo.png
     - 운영 환경 (Linux):   /app/shipmg/www/images/common/logo.png
     - 김광열 

  2. 로고 파일 형식 주의:
     - 반드시 PNG 형식이어야 함 (WEBP는 Java ImageIO에서 지원 안 됨)
     - 파일명은 logo.png지만 실제 형식이 WEBP인 경우 PDF 생성 시 이미지가 안 보임

  3. 이미지 처리 방식:
     - PdfGenerationService.processImagesInHtml()이 로컬 경로를 자동으로 Base64로 변환
     - 서명/인감 이미지는 Handlebars 변수로 이미 Base64 처리됨

  4. Flying Saucer PDF 엔진 제약사항:
     - XHTML 1.0 Strict 필수
     - CSS 2.1만 지원 (Flexbox, transform 등 최신 CSS 불가)
     - 모든 태그는 self-closing (예: <img />, <br />)
     - 테이블 기반 레이아웃 사용 필수
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>기포단열재 납품확인서</title>
  <style>
    @font-face {
      font-family: 'MalgunGothic';
      src: url('file:///C:/Windows/Fonts/malgun.ttf');
      -fs-pdf-font-embed: embed;
      -fs-pdf-font-encoding: Identity-H;
    }

    @page {
      size: A4;
      margin: 12mm 15mm;
    }

    * {
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'MalgunGothic', serif;
      font-size: 10pt;
      line-height: 1.5;
    }

    /* ========== Document Title ========== */
    .document-title {
      text-align: center;
      font-size: 20pt;
      font-weight: bold;
      letter-spacing: 10px;
      margin: 15px 0 20px 0;
      text-decoration: underline;
    }

    /* ========== Header Section ========== */
    .header-container {
      width: 100%;
      margin-bottom: 20px;
    }

    .header-table {
      width: 100%;
      border-collapse: collapse;
    }

    .header-left {
      width: 45%;
      vertical-align: top;
      padding: 10px 15px;
      font-size: 10pt;
      line-height: 1.8;
    }

    /* 좌측 내부 테이블 (보이지 않는 구조) */
    .header-left-inner {
      width: 100%;
      border-collapse: collapse;
      border: 0;
    }

    .header-left-inner tr {
      border: 0;
    }

    .header-left-inner td {
      border: 0;
      padding: 0 0 3px 0;
      vertical-align: top;
      line-height: 1.8;
    }

    .label-col {
      width: 110px;
      font-weight: bold;
      white-space: nowrap;
    }

    .data-col {
      word-break: break-word;
    }

    /* 우측: 정보박스 (55%) */
    .header-right {
      width: 55%;
      vertical-align: top;
      padding: 5px;
    }

    /* ========== Info Box Table ========== */
    .info-box {
      width: 100%;
      border: 2px solid #000;
      border-collapse: separate;
      border-spacing: 0;
      font-size: 7pt;
    }

    .info-box th,
    .info-box td {
      border-left: 1px solid #000;
      border-top: 1px solid #000;
      padding: 5px 8px;
      text-align: center;
      vertical-align: middle;
    }

    .info-box tr th:first-child,
    .info-box tr td:first-child {
      border-left: none;
    }

    .info-box tr:first-child th,
    .info-box tr:first-child td {
      border-top: none;
    }

    .info-box th {
      background-color: #f0f0f0;
      font-weight: bold;
    }

    .info-box td.text-left {
      text-align: left;
      padding-left: 10px;
    }

    /* ========== Section Title ========== */
    .section-title {
      font-size: 11pt;
      font-weight: bold;
      margin: 15px 0 8px 0;
      padding-left: 3px;
    }

    /* ========== Contract Table ========== */
    .contract-table {
      width: 100%;
      border: 2px solid #000;
      border-collapse: separate;
      border-spacing: 0;
      margin-bottom: 20px;
    }

    .contract-table th,
    .contract-table td {
      border-left: 1px solid #000;
      border-top: 1px solid #000;
      padding: 4px;
      text-align: center;
      vertical-align: middle;
      font-size: 7pt;
    }

    .contract-table thead tr th:first-child,
    .contract-table tbody tr td:first-child {
      border-left: none;
    }

    .contract-table thead tr:first-child th {
      border-top: none;
    }

    .contract-table th {
      background-color: #e8e8e8;
      font-weight: bold;
    }

    .contract-table td.text-left {
      text-align: left;
      padding-left: 10px;
    }

    .contract-table td.text-right {
      text-align: right;
      padding-right: 10px;
    }

    .contract-table td.text-center {
      text-align: center;
    }

    .contract-table .summary-row {
      font-weight: bold;
      background-color: #f5f5f5;
    }

    /* ========== Delivery Table ========== */
    .delivery-table {
      width: 100%;
      border: 2px solid #000;
      border-collapse: separate;
      border-spacing: 0;
      margin-bottom: 0;
    }

    .delivery-table th,
    .delivery-table td {
      border-left: 1px solid #000;
      border-top: 1px solid #000;
      padding: 4px;
      text-align: center;
      vertical-align: middle;
      font-size: 7pt;
    }

    .delivery-table thead tr th:first-child,
    .delivery-table tbody tr td:first-child {
      border-left: none;
    }

    .delivery-table thead tr:first-child th {
      border-top: none;
    }

    .delivery-table th {
      background-color: #e8e8e8;
      font-weight: bold;
    }

    .delivery-table td.text-left {
      text-align: left;
      padding-left: 10px;
    }

    .delivery-table td.text-right {
      text-align: right;
      padding-right: 10px;
    }

    .delivery-table .total-row {
      font-weight: bold;
      background-color: #f0f0f0;
    }

    .delivery-table .empty-row {
      height: 25px;
    }

    /* ========== Signature Section (Notice 포함) ========== */
    .signature-section {
      width: 100%;
      border: 2px solid #000;
      border-collapse: separate;
      border-spacing: 0;
      margin-bottom: 20px;
      table-layout: fixed;
    }

    .signature-section tr {
      border: none;
    }

    .notice-cell {
      text-align: center;
      padding: 15px 0;
      font-size: 10pt;
      line-height: 1.6;
      border-left: none;
      border-right: none;
      border-top: none;
      border-bottom: 1px solid #000;
    }

    .signature-section td {
      border-left: none;
      border-right: none;
      border-top: none;
      border-bottom: none;
      padding: 10px 15px;
      vertical-align: middle;
      font-size: 10pt;
      line-height: 2.0;
    }

    .signature-row {
      width: 100%;
      border: none;
    }

    .signature-row td {
      border-left: none;
      border-right: none;
      border-top: none;
      border-bottom: none;
    }

    .sig-label {
      text-align: right;
      font-weight: bold;
      padding-right: 10px;
      width: 100px;
    }

    .sig-content {
      text-align: left;
      padding-left: 15px;
      position: relative;
      width: 200px;
      white-space: nowrap;
    }

    .sig-stamp {
      text-align: center;
      color: #999;
      width: 120px;
      font-size: 9pt;
      position: relative;
    }

    .sig-image {
      position: absolute;
      right: 10px;
      top: -12px;
      width: 90px;
      height: 76px;
      z-index: 10;
    }

    /* ========== Footer Date ========== */
    .footer-date {
      text-align: center;
      margin-top: 20px;
      font-size: 12pt;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- Document Title -->
  <div class="document-title">기포단열재납품확인서</div>

  <!-- Header: 2단 구조 -->
  <div class="header-container">
    <table class="header-table">
      <tr>
        <!-- 좌측: 텍스트 정보 (동적 데이터) -->
        <td class="header-left">
          <table class="header-left-inner">
            <tr>
              <td class="label-col">납품요구번호 :</td>
              <td class="data-col">{{deliveryRequestNo}}</td>
            </tr>
            <tr>
              <td class="label-col">수&nbsp; 요&nbsp; 기&nbsp; 관 :</td>
              <td class="data-col">{{demandAgency}}</td>
            </tr>
            <tr>
              <td class="label-col">공 &emsp;사 &emsp;명 :</td>
              <td class="data-col">{{projectName}}</td>
            </tr>
            <tr>
              <td class="label-col">납&nbsp; 품&nbsp; 기&nbsp; 한 :</td>
              <td class="data-col">{{deliveryDeadline}}</td>
            </tr>
          </table>
        </td>

        <!-- 우측: 정보박스 -->
        <td class="header-right">
          <table class="info-box">
            <tr>
              <th colspan="2">등록 번호</th>
              <td colspan="3"><strong>129-86-71834</strong></td>
            </tr>
            <tr style="height: 40px;">
              <th rowspan="1">상 호</th>
              <td>주식회사 리드파워</td>
              <th>성 명</th>
              <td colspan="2" style="position: relative;">김광렬{{#if companySealImage}}<img src="{{companySealImage}}" alt="직인" style="position: absolute; left: 80px; top: -19px; width: 80px; height: 80px; z-index: 10;" />{{/if}}</td>
            </tr>
            <tr>
              <th colspan="2">사업장주소</th>
              <td colspan="3" class="text-left">경기도 안성시 서운면 서미로 21-10</td>
            </tr>
            <tr>
              <th>업 태</th>
              <td>제조업</td>
              <th>종 목</th>
              <td colspan="2" class="text-left">플라스틱발포성형제품제조업</td>
            </tr>
            <tr>
              <th colspan="2">연락 번호</th>
              <td colspan="3">T:031-671-9322, F:031-671-9323</td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </div>

  <!-- Section 1: 계약물품 -->
  <div class="section-title">1. 계약물량</div>
  <table class="contract-table">
    <thead>
      <tr>
        <th style="width: 35%;">품 명</th>
        <th style="width: 10%;">두 께<br />(㎜)</th>
        <th style="width: 12%;">품 목<br />(㎡)</th>
        <th style="width: 13%;">단 가</th>
        <th style="width: 15%;">금 액</th>
        <th style="width: 15%;">비 고</th>
      </tr>
    </thead>
    <tbody>
      {{#each contractItems}}
      <tr>
        <td class="text-center">{{name}}</td>
        <td class="text-right">{{thickness}}</td>
        <td class="text-right">{{quantity}}</td>
        <td class="text-right">{{unitPrice}}</td>
        <td class="text-right">{{totalAmount}}</td>
        <td>{{remark}}</td>
      </tr>
      {{/each}}

      {{#unless hasEnoughRows}}
      <tr>
        <td>&nbsp;</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr class="empty-row">
        <td>&nbsp;</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      {{/unless}}

      {{#if hasPriceAdjustment}}
      <tr class="summary-row">
        <td>단가정정</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      {{/if}}
      {{#if discountRate}}
      <tr class="summary-row">
        <td>할인율 {{discountRate}}%</td>
        <td></td>
        <td></td>
        <td></td>
        <td class="text-right">{{discountAmount}}</td>
        <td></td>
      </tr>
      {{/if}}
      <tr class="summary-row">
        <td>합 계</td>
        <td></td>
        <td class="text-right">{{totalQuantity}}</td>
        <td></td>
        <td class="text-right">{{totalAmount}}</td>
        <td></td>
      </tr>
    </tbody>
  </table>

  <!-- Section 2: 납품내역 -->
  <div class="section-title">2. 납품내역</div>
  <table class="delivery-table">
    <thead>
      <tr>
        <th style="width: 20%;">규 격</th>
        {{#each deliveryDates}}
        <th>{{this}}</th>
        {{/each}}
      </tr>
    </thead>
    <tbody>
      {{#each productRows}}
      <tr>
        <td class="text-left">{{productName}}</td>
        {{#each quantities}}
        <td class="text-right">{{this}}</td>
        {{/each}}
      </tr>
      {{/each}}

      <tr class="empty-row">
        <td colspan="{{columnCount}}"></td>
      </tr>

      <tr class="total-row">
        <td class="text-center">합 계</td>
        {{#each dateTotals}}
        <td class="text-right">{{this}}</td>
        {{/each}}
      </tr>
    </tbody>
  </table>

  <!-- Notice & Signature Section (통합) -->
  <table class="signature-section">
    <!-- Notice Row -->
    <tr>
      <td colspan="6" class="notice-cell">
        상기 물품에 대하여 생산, 납품하였음을 확인 합니다.
      </td>
    </tr>
    <tr class="signature-row">
      <td class="sig-label"></td>
      <td class="sig-label"></td>
      <td class="sig-label"></td>
      <td colspan="2" class="sig-label">시 공 사 :</td>
      <td class="sig-content">현장소장 {{contractorName}}</td>
      <td class="sig-stamp">{{#if managerSignatureImage}}<img src="{{managerSignatureImage}}" alt="서명" class="sig-image" />{{/if}}[인]</td>
    </tr>
    <tr class="signature-row">
      <td class="sig-label"></td>
      <td class="sig-label"></td>
      <td class="sig-label"></td>
      <td colspan="2" class="sig-label">현장감리원 :</td>
      <td class="sig-content">감리원 {{supervisorName}}</td>
      <td class="sig-stamp">{{#if inspectorSignatureImage}}<img src="{{inspectorSignatureImage}}" alt="서명" class="sig-image" />{{/if}}[인]</td>
    </tr>
    <tr class="signature-row">
      <td class="sig-label"></td>
      <td class="sig-label"></td>
      <td class="sig-label"></td>
      <td colspan="2" class="sig-label">소속감리원 :</td>
      <td class="sig-content">{{inspectorName}}</td>
      <td class="sig-stamp">(인)</td>
    </tr>
  </table>

  <!-- Footer Date -->
  <div class="footer-date">
    {{submissionYear}}년   {{submissionMonth}}월   {{submissionDay}}일
  </div>
</body>
</html>
